.INCLUDE "M8535DEF.INC"
.ORG 0

RJMP MAIN

MAIN :	LDI R17,LOW(RAMEND)
		OUT SPL,R17
		LDI R17,HIGH(RAMEND)
		OUT SPH,R17

		//GET DATA1 FROM MEMORY
		LDI ZL,LOW(2*DATA1)
		LDI ZH,HIGH(2*DATA1)

		LPM R10,Z+
		LPM R9,Z+
		LPM R8,Z+
		LPM R7,Z+
		LPM R6,Z+
		LPM R5,Z+
		LPM R4,Z+
		LPM R3,Z+

		//GET DATA2 FROM MEMORY
		LDI ZL,LOW(2*DATA2)
		LDI ZH,HIGH(2*DATA2)

		LPM R20,Z+
		LPM R19,Z+
		LPM R18,Z+
		LPM R17,Z+
		LPM R16,Z+
		LPM R15,Z+
		LPM R14,Z+
		LPM R13,Z+
		
		SUB R10,R20
		SBC R9,R19
		SBC R8,R18
		SBC R7,R17
		SBC R6,R16
		SBC R5,R15
		SBC R4,R14
		SBC R3,R13
		
		//STORE HASIL
		LDI ZL,LOW(2*HASIL)
		LDI ZH,HIGH(2*HASIL)

		ST Z+,R10
		ST Z+,R9
		ST Z+,R8
		ST Z+,R7
		ST Z+,R6
		ST Z+,R5
		ST Z+,R4
		ST Z+,R3		

AKHIR:	RJMP AKHIR

.ORG $0100
DATA1: .DQ $FEFEFEFEFEFEFEFE

.ORG $0105
DATA2: .DQ $123456789ABCDEF0

.ORG $066
HASIL: .DQ $0

